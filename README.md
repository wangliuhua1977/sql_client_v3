# SQL Notebook (sql_client_v2)

面向 Windows 11 风格的多标签 SQL 笔记本，基于 Java 22 + Swing + RSyntaxTextArea，支持 PostgreSQL / Hive 编辑、自动保存、离线元数据联想与双向链接标记。

## 主要功能
- **多窗口 SQL/Markdown 笔记**：使用 `JDesktopPane + JInternalFrame` 子窗口模式，支持拖动、最大化、最小化、调整大小与双击重命名；窗口可平铺排列。
- **数据库内笔记管理**：所有笔记以 Markdown 文本存储在本地 SQLite `notes` 表中，通过“打开/管理笔记”从数据库选择，无需文件系统。
- **自动保存**：每个窗口独立后台线程定期写入数据库，状态栏显示最近保存时间。
- **智能联想**：仅在表/视图、字段、函数/存储过程位置弹出；支持 Ctrl+Space 开关、上下键与回车/双击选择；使用频次排序与高亮，记录使用次数。
- **别名与模糊匹配**：`FROM/JOIN` 别名可用于列联想，支持 `%` 分词模糊匹配与下划线连续输入不关闭联想框。
- **双向链接**：编辑器内可插入 `[[标记]]`，支持跳转与反向链接解析。
- **元数据缓存与差分更新**：通过 HTTPS 拉取对象/列信息，信任局域网证书，写入本地 SQLite（WAL + busy timeout），只插入新增、删除缺失并按需更新列。
- **线程模型**：网络抓取、元数据维护、自动保存使用独立线程池，保持 UI 流畅。

## 快速开始
1. 确保安装 JDK 22 与 Maven，并允许访问 Maven Central。
2. 执行 `mvn -DskipTests package` 生成可执行 fat JAR。
3. 运行 `java -jar target/sql_client-*-jar-with-dependencies.jar` 启动应用。

> 若容器/网络限制导致构建失败，可在联网环境下重新执行 Maven 下载依赖。

## 版本更新日志
- **v0.3.1**
  - 双击子窗口重命名后保持原有位置与大小，不影响其他窗口。
  - 联想列表在方向键导航时不再跳回第一项，保持当前位置；`表别名.` 触发列补全。
  - 继续支持 `%` 分词模糊匹配与使用次数高亮排序，列补全会根据别名解析到真实表名。
- **v0.3.0**
  - 笔记改为 SQLite 存储（Markdown 文本），通过“打开/管理笔记”在数据库内创建、打开与保存。
  - 编辑区域改用内部子窗口，支持拖拽、最大化/最小化、平铺、双击重命名，关闭对象树仅保留笔记窗口与状态栏。
  - 联想框上下键不再自动跳回首项，支持 `%` 模糊分词，选择后按上下文替换当前片段并记录使用次数排序。
- **v0.2.0**
  - 完成文件打开/保存/保存全部功能，支持选择数据库类型并更新标签标题。
  - 联想框仅在选择后关闭，支持上下键/回车/双击选择、别名列补全与下划线连续输入。
  - 补全时替换当前输入片段并记录使用次数排序，高亮已使用条目。
- **v0.1.x**
  - 初版 UI、元数据差分更新、自动保存、多线程和基础联想能力。

